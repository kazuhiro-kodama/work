# Task Specification  


## 1. Basic Information  

|**SysNm**|**SubSysCd**|**SubSysNm**|**Task ID**|**Task Name**|
|:---:|:---:|:---:|:---:|:---:|
|`PCS`|`N62`|`車両管理`|`E62X20`|`仕様別ファイル新旧コンバージョン`|

## 2. Overview  

## 3. Input / Output Information  

1. Input entity  

|**No**|**Key**|**Type**|**Logical Name**|**Remarks**|
|---:|:---|:---:|:---|:---|
|1|`SYS011`|`Memory`|`製販仕様別ファイル`||

2. Output entity  

|**No**|**Key**|**Type**|**LogicalName**|**Remarks**|
|---:|:---|:---:|:---|:---|
|1|`SYS031`|`Memory`|`CATS仕様別レコード`||

3. Parameter entity  

|**No**|**Key**|**Type**|**LogicalName**|**Remarks**|
|---:|:---|:---:|:---|:---|

## 4. Task Detail Definition  

#### 1. Main process (MainShori)

1. **[2. Start process (KaisiShori))](#2-start-process-kaisishori)**を呼び出す。
1. 変数i1EofSwに変数offCodeをセットする。
1. **[3. Seihan FL input per spec process (SeihanShiyouBetsuFlInshori)](#3-seihan-fl-input-per-spec-process-seihanshiyoubetsuflinshori)**を呼び出す。
1. 以下の条件になるまでの間、**[4. CATS FL creation per spec (CatsShiyouBetsuFlSakusei)](#4-cats-fl-creation-per-spec-catsshiyoubetsuflsakusei)**の呼び出しをループする。

    > 変数i1Eof = `true`

1. **[13. End process (ShuryoShori)](#13-end-process-shuryoshori)**を呼び出す。


#### 2. Start process (KaisiShori)

1. 変数i1NseqKeyに16進数の`00`をセットする。


#### 3. Seihan FL input per spec process (SeihanShiyouBetsuFlInshori)

1. リスト変数i1SeihanShiyouBetsuFlのレコードを1件読込み、変数i1SeihanShiyouBetsuRecにセットする。
    1. 読み込んだレコードが`END`であれば、変数retCd1に`EOF`をセットする。
    1. 読み込んだレコードが`END`でなければ、変数retCd1に`NML`をセットする。
1. 変数retcd1が`EOF`であるかどうかチェックする。
1. [変数retcd1が`EOF`の場合]
    1. 変数i1EofSwに変数onCodeをセットする。
    1. 変数i1Eofが`false`であるかどうかチェックする。
    1. [変数i1Eofが`false`の場合]
        1. 変数i1OseqKeyに変数i1NseqKeyをセットする。
        1. 変数i1NseqKojoKubunに変数i1KoujouKubunをセットする。
        1. 変数i1NseqShashuに変数i1Shashuをセットする。
        1. 変数i1NseqLine1ketaに変数i1Shimo1ketaをセットする。
        1. 変数i1NseqToshokuに変数i1Toshokuをセットする。
        1. 変数i1NseqUchibariに変数i1Uchibariをセットする。
        1. 変数i1NseqExNoに変数i1ExNoをセットする。
        1. 変数i1NseqKouteiShikibetsuに変数i1KouteiShikibetsuをセットする。
        1. 変数i1NseqKeyが変数i1QseqKeyより大きくないかどうかチェックする。
        1. [変数i1NseqKeyが変数i1QseqKeyより大きくない場合]
        	1. コンソールに以下の内容を表示する。

        		> 'ｾｲﾊﾝｼﾖｳﾍﾞﾂ ﾌｧｲﾙ ｼｰｹﾝｽﾀﾞｳﾝ'

        	1. コンソールに以下の内容を表示する。

        		> '**OLD KEY = '  I1-OSEQ-KEY

        	1. コンソールに以下の内容を表示する。

        		> '**NEW KEY = '  I1-NSEQ-KEY

			1. タスク**TERMDUMP**を呼び出す。
			1. 変数i1Eofが`false`であるかどうかチェックする。
			1. [変数i1Eofが`false`の場合]
				1. 変数i1NsamKoujouKubunに変数i1KoujouKubunをセットする。
				1. 変数i1NsamShashuに変数i1Shashuをセットする。
				1. 変数i1NsamLine1ketaに変数i1Shimo1ketaをセットする。
				1. 変数i1NsamToshokuに変数i1Toshokuをセットする。
				1. 変数i1NsamUchibariに変数i1Uchibariをセットする。
				1. 変数i1NsamExNoに変数i1ExNoをセットする。
			1. [変数i1Eofが`false`でない場合]
				1. 変数i1NsamKeyに16進数の`FF`をセットする。

#### 4. CATS FL creation per spec (CatsShiyouBetsuFlSakusei)

1. **[5. Seihan spec initial process (SeihanShiyouShokiShori)](#5-seihan-spec-initial-process-seihanshiyoushokishori)**を呼び出す。
1. 変数i1OsamKeyに変数i1NsamKeyをセットする。
1. 以下の条件になるまでの間、**[6. Seihan SAM process loop (SeihanSamShoriLoop)](#6-seihan-sam-process-loop-seihansamshoriloop)**の呼び出しをループする。

    > 変数i1NsamKey = 変数i1OsamKey

1. **[12. O1 REC out process (O1RecOutShori)](#12-o1-rec-out-process-o1recoutshori)**を呼び出す。

#### 5. Seihan spec initial process (SeihanShiyouShokiShori)

1. 変数o1CatsShiyouBetsuRecを初期化する。
1. 変数o1KoujouKubunに変数i1KoujouKubunをセットする。
1. 変数o1Shashuに変数i1Shashuをセットする。
1. 変数o1Toshokuに変数i1Toshokuをセットする。
1. 変数o1Uchibariに変数i1Uchibariをセットする。
1. 変数o1ExNoに変数i1ExNoをセットする。
1. 変数o1TrimLineに変数i1TrimLineをセットする。
1. 変数o1KokuyuKubunに変数i1KokuyuKubunをセットする。
1. 変数o1KeikakuNengetsuに変数i1TaishouNengetsuをセットする。

#### 6. Seihan SAM process loop (SeihanSamShoriLoop)

1. **[7. Seihan SAM process (SeihanSamShori)](#7-seihan-sam-process-seihansamshori)**を呼び出す。
1. **[3. Seihan FL input per spec process (SeihanShiyouBetsuFlInshori)](#3-seihan-fl-input-per-spec-process-seihanshiyoubetsuflinshori)**を呼び出す。

#### 7. Seihan SAM process (SeihanSamShori)

1. 変数i1KouteiShikibetsuが`10`であるかどうかチェックする。
1. [変数i1KouteiShikibetsuが`10`の場合]
	1. **[8. Off line process (OffLineShori)](#8-off-line-process-offlineshori)**を呼び出す。
	1. 変数o1OffGettoRuisaに変数i1ZengetsuMatsuRuisaをセットする。
1. [変数i1KouteiShikibetsuが`10`でない場合]
	1. (変数i1KouteiShikibetsuが`15`かつ変数i1KoujouKubunが`?`である)又は(変数i1KouteiShikibetsuが`20`かつ変数i1KoujouKubunが`?`でない)かチェックする。
	1. [(変数i1KouteiShikibetsuが`15`かつ変数i1KoujouKubunが`?`である)又は(変数i1KouteiShikibetsuが`20`かつ変数i1KoujouKubunが`?`でない)である場合]
		1. **[9. Final process (FinalShori)](#9-final-process-finalshori)**を呼び出す。
		1. 変数o1FinGettoRuisaに変数i1ZengetsuMatsuRuisaをセットする。
	1. [(変数i1KouteiShikibetsuが`15`かつ変数i1KoujouKubunが`?`である)又は(変数i1KouteiShikibetsuが`20`かつ変数i1KoujouKubunが`?`でない)でない場合]
		1. 変数i1KouteiShikibetsuが`30`であるかどうかチェックする。
		1. [変数i1KouteiShikibetsuが`30`の場合]
			1. 変数o1MikenZaikoに変数i1ZenGetsuMikenをセットする。
			1. 変数o1IkanShikyuTougetsuに変数i1TougetsuRuikeiIkanを加える。
			1. 変数o1IkanShikyuJigetsuに変数i1JigetsuRuikeiIkanを加える。
			1. 変数o1IkanShikyuTougetsuに変数i1TougetsuShikyuを加える。
			1. 変数o1IkanShikyuJigetsuに変数i1ZigetsuShikyuを加える。
		1. [変数i1KouteiShikibetsuが`30`でない場合]
			1. 変数i1KouteiShikibetsuが`50`であるかどうかチェックする。
			1. [変数i1KouteiShikibetsuが`50`の場合]
				1. **[11. Shauke process (ShaukeShori)](#11-shauke-process-shaukeshori)**を呼び出す。
				1. 変数o1Kankenに変数i1ZenGetsuKankenをセットする。

#### 8. Off line process (OffLineShori)

1. 変数o1OffJissekiTougetsuDaisu(1)に`変数i1TougetsuJisseki10 + 変数i1TougetsuJisseki1(1) + 変数i1TougetsuJisseki2(1)`をセットする。
1. 変数o1OffJissekiJigetsuDaisu(1)に`変数i1JigetsuJisseki10 + 変数i1JigetsuJisseki1(1) + 変数i1JigetsuJisseki2(1)`をセットする。
1. 変数o1OffKeikakuTougetsuDaisu(1)に`変数i1TougetsuKeikaku10 + 変数i1TougetsuKeikaku1(1) + 変数i1TougetsuKeikaku2(1)`をセットする。
1. 変数o1OffKeikakuJigetsuDaisu(1)に`変数i1JigetsuKeikaku10 + 変数i1JigetsuKeikaku1(1) + 変数i1JigetsuKeikaku2(1)`をセットする。
1. 変数i1Ctrに`2`をセットする。
1. 以下の条件になるまでの間、次の処理をループする。

    > 変数i1Ctr > `31`

	1. 変数o1OffJissekiTougetsuDaisu(i1Ctr)に`変数i1TougetsuJisseki1(i1Ctr) + 変数i1TougetsuJisseki2(i1Ctr)`をセットする。
	1. 変数o1OffKeikakuTougetsuDaisu(i1Ctr)に`変数i1TougetsuKeikaku1(i1Ctr) + 変数i1TougetsuKeikaku2(i1Ctr)`をセットする。
	1. 変数i1Ctrに`1`を加える。
1. 変数i1Ctrに`2`をセットする。
1. 以下の条件になるまでの間、次の処理をループする。

    > 変数i1Ctr > `20`

	1. 変数o1OffJissekiJigetsuDaisu(i1Ctr)に`変数i1JigetsuJisseki1(i1Ctr) + 変数i1JigetsuJisseki2(i1Ctr)`をセットする。
	1. 変数o1OffKeikakuJigetsuDaisu(i1Ctr)に`変数i1JigetsuKeikaku1(i1Ctr) + 変数i1JigetsuKeikaku2(i1Ctr)`をセットする。
	1. 変数i1Ctrに`1`を加える。


#### 9. Final process (FinalShori)

1. 変数o1FinJissekiTougetsuDaisu(1)に`変数i1TougetsuJisseki10 + 変数i1TougetsuJisseki1(1) + 変数i1TougetsuJisseki2(1)`をセットする。
1. 変数o1FinJissekiJigetsuDaisu(1)に`変数i1JigetsuJisseki10 + 変数i1JigetsuJisseki1(1) + 変数i1JigetsuJisseki2(1)`をセットする。
1. 変数o1FinKeikakuTougetsuDaisu(1)に`変数i1TougetsuKeikaku10 + 変数i1TougetsuKeikaku1(1) + 変数i1TougetsuKeikaku2(1)`をセットする。
1. 変数o1FinKeikakuJigetsuDaisu(1)に`変数i1JigetsuKeikaku10 + 変数i1JigetsuKeikaku1(1) + 変数i1JigetsuKeikaku2(1)`をセットする。
1. 変数i1Ctrに`2`をセットする。
1. 以下の条件になるまでの間、次の処理をループする。

    > 変数i1Ctr > `31`

	1. 変数o1FinJissekiTougetsuDaisu(i1Ctr)に`変数i1TougetsuJisseki1(i1Ctr) + 変数i1TougetsuJisseki2(i1Ctr)`をセットする。
	1. 変数o1FinKeikakuTougetsuDaisu(i1Ctr)に`変数i1TougetsuKeikaku1(i1Ctr) + 変数i1TougetsuKeikaku2(i1Ctr)`をセットする。
	1. 変数i1Ctrに`1`を加える。
1. 変数i1Ctrに`2`をセットする。
1. 以下の条件になるまでの間、次の処理をループする。

    > 変数i1Ctr > `20`

	1. 変数o1FinJissekiJigetsuDaisu(i1Ctr)に`変数i1JigetsuJisseki1(i1Ctr) + 変数i1JigetsuJisseki2(i1Ctr)`をセットする。
	1. 変数o1FinKeikakuJigetsuDaisu(i1Ctr)に`変数i1JigetsuKeikaku1(i1Ctr) + 変数i1JigetsuKeikaku2(i1Ctr)`をセットする。
	1. 変数i1Ctrに`1`を加える。

#### 10. Per month process (TsukiBetsuShori)

1. 変数o1IkanShikyuTougetsuに変数i1TougetsuJissekiをセットする。
1. 変数i1Ctrに`1`をセットする。
1. 以下の条件になるまでの間、次の処理をループする。

    > 変数i1Ctr > `31`

	1. 変数o1IkanShikyuTougetsuに`変数i1TougetsuJisseki1(i1Ctr) + 変数i1TougetsuJisseki2(i1Ctr) + 変数o1IkanShikyuTougetsu`をセットする。
	1. 変数i1Ctrに`1`を加える。
1. 変数o1IkanShikyuJigetsuに変数i1JigetsuJissekiをセットする。
1. 変数i1Ctrに`1`をセットする。
1. 以下の条件になるまでの間、次の処理をループする。

    > 変数i1Ctr > `20`

	1. 変数o1IkanShikyuJigetsuに`変数i1JigetsuJisseki1(i1Ctr) + 変数i1JigetsuJisseki2(i1Ctr) + 変数o1IkanShikyuJigetsu`をセットする。
	1. 変数i1Ctrに`1`を加える。

#### 11. Shauke process (ShaukeShori)

1. 変数o1ShaukeTougetsuDaisu(1)に`変数i1TougetsuJisseki10 + 変数i1TougetsuJisseki1(1) + 変数i1TougetsuJisseki2(1)`をセットする。
1. 変数i1Ctrに`2`をセットする。
1. 以下の条件になるまでの間、次の処理をループする。

    > 変数i1Ctr > `31`

	1. 変数o1ShaukeTougetsuDaisu(i1Ctr)に`変数i1TougetsuJisseki1(i1Ctr) + 変数i1TougetsuJisseki2(i1Ctr)`をセットする。
	1. 変数i1Ctrに`1`を加える。
1. 変数o1ShaukeJigetsuDaisu(1)に`変数i1JigetsuJisseki10 + 変数i1JigetsuJisseki1(1) + 変数i1JigetsuJisseki2(1)`をセットする。
1. 変数i1Ctrに`2`をセットする。
1. 以下の条件になるまでの間、次の処理をループする。

    > 変数i1Ctr > `20`

	1. 変数o1ShaukeJigetsuDaisu(i1Ctr)に`変数i1JigetsuJisseki1(i1Ctr) + 変数i1JigetsuJisseki2(i1Ctr)`をセットする。
	1. 変数i1Ctrに`1`を加える。


#### 12. O1 REC out process (O1RecOutShori)

1. 変数o1CatsShiyouBetsuRecを変数sys031Recに書き出す。

#### 13. End process (ShuryoShori)

1. 処理無し
